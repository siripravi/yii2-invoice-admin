Управление параметрами
======================

Получить значение параметра:

```php
$value = Param::value($key, 'default value');
```

где, `$key` ключ параметра который состоит из: названия секции и названия
параметра разделенных точкой. Например, `Site.adminEmail`.

Поиск значения параметра происходит по такой схеме:
- сначала в параметрах приложения `Yii::$app->params` (они задаются в файле
  `app/config/web.php` в массиве с индексом `params`)
- среди закешированных (параметры которые уже были запрошены ранее)
- и, наконец, в таблице `config`, после чего параметр кешируется

Описание полей таблицы config
=============================

Каждый параметр это запись в таблице `config` с такими полями:

- **name** краткое название параметра (например, adminEmail как в примере выше)
- **value** начальное значение параметра (сериализуется функцией `serialize()`)
- **value_type** тип параметра (см. ниже доступные типы)
- **options** если тип параметра `TYPE_SELECT` то содержит список доступных
  элементов для выпадающего списка (сериализуется функцией `serialize()`)
- **title** заголовок параметра на странице настроек
- **desc** описание параметра на странице настроек
- **section** название секции (вкладки) к которой относится параметр
- **required** признак что параметр является обязательным
- **perms** список прав доступа к параметру (сериализуется функцией `serialize()`)

Следует заметить, что связка **name** и **section** должна быть уникальной.
Не может быть два одинаковых параметра в одной секции.

Типы параметров
===============

Тип параметра - это виджет который будет выводится на странице настроек **Settings**.
- `TYPE_INT` поле ввода целого числа
- `TYPE_NUM` поле ввода десятичного числа
- `TYPE_EMAIL` поле ввода email адреса
- `TYPE_URL` поле ввода ссылки
- `TYPE_SWITCH` переключатель (чекбокс)
- `TYPE_TEXT` текстовое поле ввода
- `TYPE_EDITOR` редактор
- `TYPE_SELECT` выпадающий список, варианты выбора содержатся в поле `options`.
- `TYPE_PASSWORD` поле ввода пароля

Страница настроек Settings
==========================

Все параметры группируются по вкладкам (поле `section`). За работу с параметрами
отвечает класс `app\base\actions\Settings` в котором происходит рендеринг и
обработка страницы настроек.

Права доступа
=============

Поле `perms` содержит список прав доступа к параметру. Если у пользователя
нет соответствующих прав, то такой параметр будет скрыт на странице
настройек **Settings** для изменения.

Право `updateSettings` доступно для администратора, модули могут добавлять
свои права.

Добавление нового параметра
===========================

Добавление параметра - создание новой модели `Config`.

```php
$test = new Config();
$test->name = 'key';
$test->title = 'Some key';
$test->section = 'MyModule';
$test->value_type = Config::TYPE_TEXT;
$test->perms = ['MyModuleAdminSettings'];
$test->save();
```

Добавляется параметр `MyModule.key` который будет отображен на вкладке `MyModule`
и который будет доступен пользователям с правом `MyModuleAdminSettings` и для
остальных скрыт.

Добавление параметра в миграциях возможно аналогичным созданием модели `Config`:
```
public function up() {
    $config = new \app\models\Config();
    $config->name = 'fetchTime';
    $config->title = 'Remote fetch time';
    $config->section = 'Site';
    $config->value_type = \app\models\Config::TYPE_TEXT;
    $config->save();
}
public function down() {
    \app\models\Config::deleteAll([
        'name' => 'fetchTime',
        'section' => 'Site',
    ]);
}
```
